<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="static/jquery-3.2.1.slim.min.js"></script>
    <style>
        table {
            border-collapse: collapse;
        }

        td {
            border: 1px solid #eaeaea;
            padding: 10px;
        }
    </style>
</head>

<body>
    <div style="margin-bottom: 10px;">
        <input type="text" name="api" id="api" placeholder="API full link"> (eg: https://covid19.cdacchn.in/api/report,
        if this box has api link then request will be fired to that link along with object)
    </div>
    <form id="show-details-form" name="show-details-form">
        <table>
            <tr>
                <td>
                    District
                </td>
                <td>
                    <select name="district" id="district">
                        <option value="Yavatmol">Yavatmol</option>
                        <option value="Dist2">Dist2</option>
                    </select>
                </td>
            </tr>
            <tr>
                <td>
                    Based
                </td>
                <td>
                    <input type="radio" name="type" value="symptomsBased" checked>Symptoms based
                    <div style="padding: 10px;border: 1px solid #ececec;margin: 2px;">
                        <input type="checkbox" name="symptoms" value="Cough">Cough
                        <input type="checkbox" name="symptoms" value="Cold">Cold
                        <input type="checkbox" name="symptoms" value="Fever">Fever
                        <input type="checkbox" name="symptoms" value="Diabetes">Diabetes
                        <input type="checkbox" name="symptoms" value="Sari">Sari
                        <input type="checkbox" name="symptoms" value="High Risk Contact">High Risk Contact
                        <input type="checkbox" name="symptoms" value="Low Risk Contact">Low Risk Contact
                        <input type="checkbox" name="symptoms" value="PNC">PNC
                        <input type="checkbox" name="symptoms" value="ANC">ANC
                        <input type="checkbox" name="symptoms" value="Hyper Tension">Hyper Tension
                        <input type="checkbox" name="symptoms" value="Others">Others
                    </div>
                    <br>
                    <input type="radio" name="type" value="userBased">User based
                    <div style="padding: 10px;border: 1px solid #ececec;margin: 2px;">
                        <input type="number" name="mobile" id="mobile" placeholder="Mobilenumber">
                    </div>

                </td>
            </tr>
            <tr>
                <td>Date</td>
                <td>
                    <input type="radio" name="dateType" value="range" checked>Range
                    <div style="padding: 10px;border: 1px solid #ececec;margin: 2px;">
                        From: <input type="date" name="dateMin" id="dateMin">
                        To: <input type="date" name="dateMax" id="dateMax">
                    </div>
                    <input type="radio" name="dateType" value="today">As of Today
                </td>
            </tr>
            <tr>
                <td>Check</td>
                <td>
                    <input type="radio" name="check" value="all" checked>Symptom on All selected days
                    <input type="radio" name="check" value="any">Symptom on Any selected days
                </td>
            </tr>
            <tr>
                <td>Gender</td>
                <td>
                    <input type="radio" name="gender" value="Male" checked>Male
                    <input type="radio" name="gender" value="Female">Female
                    <input type="radio" name="gender" value="Both">Both
                </td>
            </tr>
            <tr>
                <td>Age</td>
                <td>
                    Min: <input type="number" name="minAge" id="minAge" value="0">
                    Max: <input type="number" name="maxAge" id="maxAge" value="0">
                </td>
            </tr>
            <tr>
                <td></td>
                <td>
                    <input type="submit" value="Submit">
                </td>
            </tr>
        </table>
    </form>

    <pre id="json"></pre>

    <script>

        $(function () {

            $("#show-details-form").on('submit', function (e) {

                e.preventDefault();

                let obj = {};

                let district = $("#district option:selected").text();

                obj['district'] = district;

                let type = $("input[name='type']:checked").val();

                obj['type'] = type;

                switch (type) {

                    case "symptomsBased":

                        let symptoms = [];

                        $('[name="symptoms"]:checkbox:checked').each(function (i) { symptoms[i] = $(this).val(); });

                        obj['symptoms'] = symptoms;

                        break;

                    case 'userBased':

                        let mobile = $('#mobile').val();

                        obj['mobile'] = mobile
                }

                let dateType = $("input[name='dateType']:checked").val();

                obj['dateType'] = dateType;

                switch (dateType) {

                    case 'today':

                        let today = new Date();

                        obj['date'] = today.getFullYear() + '-' + today.getMonth() + '-' + today.getDate()

                        break;

                    case 'range':

                        let dateMin = $('#dateMin').val();

                        let dateMax = $('#dateMin').val();

                        obj['dateRange'] = [dateMin, dateMax];
                }

                let check = $("input[name='check']:checked").val();

                obj['check'] = check;

                let minAge = $("#minAge").val();

                let maxAge = $("#maxAge").val();

                obj['age'] = [minAge, maxAge]

                console.log('object', obj);

                $("#json").html(JSON.stringify(obj))

                let api = $("#api").val();

                if (api != '') {

                    $.get(api, obj, function (res) {

                        console.log(res);
                    });
                }

            });
        });
    </script>
</body>

</html>